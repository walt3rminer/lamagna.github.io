<html>
<head>
<title>Year 2011</title>
<link rel="stylesheet" type="text/css" href="css/blogstyle.css">
</head>
<body style="margin:20;padding:0;">
<script language="javascript">
window.parent.document.title = "Year 2011";
</script>
<div id="section">
<p id="postTitle"><a href="How%20to%20obtain%20the%20flash%20videos%20in%20Firefox%204.html" id="alink">How to obtain the flash videos in Firefox 4</a></p>
Flash videos were stored in /tmp/FlashXXXX and i was able to copy 
them to another place like cp /tmp/FlashXXX ~/Desktop/new.video.mpeg.
<br />
<br />
Since Firefox 4 i thought for a moment that everything 
changed and my happy days were over but i was wrong, i remembered that with Linux there are no sad days.<br />
<br />
How to obtain the flash videos with Firefox 4:<br />
When the video already finished loading in the browser (being Youtube or any other), do this:<br />
<br />
<pre>
ps -ef | grep libflashplayer.so | grep -v grep
walter&nbsp;&nbsp; 20040 19812&nbsp; 9 11:52 ?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 00:53:34 /usr/lib/firefox-3.6.17/plugin-container /home/walter/.mozilla/plugins/libflashplayer.so 19812 plugin true
</pre>
<br />
Now, with the PID, inspect what it is opening:<br />
<br />
<br />
<pre>
root@talento:~# lsof -p 20040 | grep Flash
lsof: WARNING: can&#39;t stat() fuse.gvfs-fuse-daemon file system /home/walter/.gvfs
		Output information may be incomplete.

plugin-co 20040 walter&nbsp;&nbsp; 16u&nbsp;&nbsp; REG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 8,2&nbsp; 1249930 21708868 /tmp/FlashXXQANNm2 (deleted)
root@talento:~#
</pre>
You are interested in the file descriptor id, these are the file descriptors from that process:<br />
<br />
<br />
<pre>
root@talento:~# ls -la /proc/20040/fd/
total 0
dr-x------ 2 walter walter&nbsp; 0 2011-04-30 21:12 .
dr-xr-xr-x 7 walter walter&nbsp; 0 2011-04-30 21:06 ..
lr-x------ 1 walter walter 64 2011-04-30 21:12 0 -&gt; /dev/null
lrwx------ 1 walter walter 64 2011-04-30 21:12 1 -&gt; /home/walter/.xsession-errors
l-wx------ 1 walter walter 64 2011-04-30 21:12 10 -&gt; pipe:[18679239]
lr-x------ 1 walter walter 64 2011-04-30 21:12 11 -&gt; pipe:[18679240]
l-wx------ 1 walter walter 64 2011-04-30 21:12 12 -&gt; pipe:[18679240]
lrwx------ 1 walter walter 64 2011-04-30 21:12 13 -&gt; socket:[18679243]
lr-x------ 1 walter walter 64 2011-04-30 21:12 14 -&gt; /home/walter/.mozilla/firefox/2te1hj2x.default/cert8.db
lr-x------ 1 walter walter 64 2011-04-30 21:12 15 -&gt; /home/walter/.mozilla/firefox/2te1hj2x.default/key3.db
lrwx------ 1 walter walter 64 2011-04-30 21:15 16 -&gt; /tmp/FlashXXQANNm2 (deleted)
lr-x------ 1 walter walter 64 2011-04-30 21:16 17 -&gt; pipe:[19890054]
l-wx------ 1 walter walter 64 2011-04-30 21:16 18 -&gt; pipe:[19890054]
lr-x------ 1 walter walter 64 2011-04-30 21:16 19 -&gt; pipe:[19890055]
lrwx------ 1 walter walter 64 2011-04-30 21:12 2 -&gt; /home/walter/.xsession-errors
l-wx------ 1 walter walter 64 2011-04-30 21:16 20 -&gt; pipe:[19890055]
lrwx------ 1 walter walter 64 2011-04-30 21:16 21 -&gt; socket:[19890059]
lrwx------ 1 walter walter 64 2011-04-30 21:12 22 -&gt; socket:[19338003]
lr-x------ 1 walter walter 64 2011-04-30 21:12 23 -&gt; anon_inode:inotify
lrwx------ 1 walter walter 64 2011-04-30 21:12 3 -&gt; socket:[18679123]
lrwx------ 1 walter walter 64 2011-04-30 21:12 4 -&gt; anon_inode:[eventpoll]
lrwx------ 1 walter walter 64 2011-04-30 21:12 42 -&gt; socket:[18679124]
lrwx------ 1 walter walter 64 2011-04-30 21:12 5 -&gt; socket:[18679236]
lrwx------ 1 walter walter 64 2011-04-30 21:12 6 -&gt; socket:[18679237]
lr-x------ 1 walter walter 64 2011-04-30 21:12 7 -&gt; pipe:[18679238]
<span style="font-family: &quot;Courier New&quot;,Courier,monospace;">l-wx------ 1 walter walter 64 2011-04-30 21:12 8 -&gt; pipe:[18679238]
lr-x------ 1 walter walter 64 2011-04-30 21:12 9 -&gt; pipe:[18679239]
</pre>
<br />
What is of our interest if the Flash process, displayed in the previous lines.<br />
<br />
Now, you can copy the file to a safe place, because, if you close Firefox, those files are released and lost.<br />
<br />
<span style="font-family: &quot;Courier New&quot;,Courier,monospace;">cp /proc/20040/fd/16 ~/Desktop/A.Movie.mpeg</span><br />
<br />
Now if you want to put everything in a script:<br />
<br />
<pre>
root@talento:~# cat saveflash.sh
#!/bin/bash</span><br />
PID=`ps -ef | grep libflashplayer.so | grep -v grep | awk &#39;{print $2}&#39;`
FD=`lsof -p $PID | grep Flash | awk &#39;{print $4}&#39; | sed &#39;s/u$//&#39;`
cp /proc/$PID/fd/$FD &quot;$1&quot;
</pre>
And remember, you can &quot;invite me a coffee&quot; :) <div style="clear: both;"></div>
<b>Published: Saturday, April 30, 2011</b>
<a href="tag_admin">admin</a>&nbsp;
</div>

<hr>
</body></html>
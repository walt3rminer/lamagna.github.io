<html>
<head>
<title>TCP Wrappers Configuration Files</title>
<link rel="stylesheet" type="text/css" href="css/blogstyle.css">
</head>
<body>
<script language="javascript">
window.parent.document.title = "TCP Wrappers Configuration Files";
</script>
<div id="section"><p id="postTitle">TCP Wrappers Configuration Files</p>
<p> To determine if a client machine is allowed to connect to a service, TCP wrappers reference the following two files, which are commonly referred to as hosts access files: <br /><ul><li><tt class="FILENAME">/etc/hosts.allow</tt><br /><li><tt class="FILENAME">/etc/hosts.deny</tt><br /></ul>When a client request is received by a TCP wrapped service, it takes the following basic steps: <br /><ol type="1"><li><i class="EMPHASIS">The service references <tt class="FILENAME">/etc/hosts.allow</tt>.</i> &mdash; The TCP wrapped service sequentially parses the <tt class="FILENAME">/etc/hosts.allow</tt> file and applies the first rule specified for that service. If it finds a matching rule, it allows the connection. If not, it moves on to step 2. <br /><li><i class="EMPHASIS">The service references <tt class="FILENAME">/etc/hosts.deny</tt>.</i> &mdash; The TCP wrapped service sequentially parses the <tt class="FILENAME">/etc/hosts.deny</tt> file. If it finds a matching rule is denies the connection. If not, access to the service is granted. <br /></ol>The following are important points to consider when using TCP wrappers to protect network services: <br /><ul><li>Because access rules in <tt class="FILENAME">hosts.allow</tt> are applied first, they take precedence over rules specified in <tt class="FILENAME">hosts.deny</tt>. Therefore, if access to a service is allowed in <tt class="FILENAME">hosts.allow</tt>, a rule denying access to that same service in <tt class="FILENAME">hosts.deny</tt> is ignored. <br /><li>Since the rules in each file are read from the top down and the first matching rule for a given service is the only one applied, the order of the rules is extremely important. <br /><li>If no rules for the service are found in either file, or if neither file exists, access to the service is granted. <br /><li>TCP wrapped services do not cache the rules from the hosts access files, so any changes to <tt class="FILENAME">hosts.allow</tt> or <tt class="FILENAME">hosts.deny</tt> take effect immediately without restarting network services.<br /><h2 class="SECT2">&nbsp;</h2><br /></ul><div style="clear: both;"></div>
<b>Published: Friday, November 13, 2009</b>
<hr>
</body></html>
<html>
<head>
<title>Some linux firewall tips</title>
<link rel="stylesheet" type="text/css" href="css/blogstyle.css">
</head>
<body>
<script language="javascript">
window.parent.document.title = "Some linux firewall tips";
</script>
<div id="section"><p id="postTitle">Some linux firewall tips</p>
<p>The overconnected world needs some extra knowledge about protecting yourself from anti-democracy financed cyber-bandits,
so here some small but powerfull firewall setup tips:<br />
<br />
<b><u>Firewall setup:</u></b>
<pre>
<span style="color: #888888">iptables -F </span>
<span style="color: #888888">iptables -P INPUT DROP </span>
<span style="color: #888888">iptables -P OUTPUT DROP </span>
<span style="color: #888888">iptables -P FORWARD DROP </span>
<span style="color: #888888"># There is no return once you know these logging lines: </span>
<span style="color: #888888">iptables -A INPUT -p icmp -m limit -j LOG --log-prefix &quot;ICMP/IN: &quot; </span>
<span style="color: #888888">iptables -A OUTPUT -p icmp -m limit -j LOG --log-prefix &quot;ICMP/OUT: &quot; </span>
<span style="color: #888888">iptables -A INPUT -p tcp -m limit -j LOG --log-prefix &quot;TCP/IN: &quot; </span>
<span style="color: #888888">iptables -A OUTPUT -p tcp -m limit -j LOG --log-prefix &quot;TCP/OUT: &quot; </span>
<span style="color: #888888">iptables -A INPUT -p udp -m limit -j LOG --log-prefix &quot;UDP/OUT: &quot; </span>
<span style="color: #888888">iptables -A OUTPUT -p udp -m limit -j LOG --log-prefix &quot;UDP/OUT: &quot; </span>
</pre>
<br />
<b><u>Syslog setup, typically /etc/rsyslog.d/iptables.conf</u></b><br />
<pre>
:msg,contains,&quot;ICMP/IN:&quot; /var/log/iptables.log</span>
<span style="color: #888888">:msg,contains,&quot;ICMP/OUT:&quot; /var/log/iptables.log</span>
<span style="color: #888888">:msg,contains,&quot;TCP/IN:&quot; /var/log/iptables.log</span>
<span style="color: #888888">:msg,contains,&quot;TCP/OUT:&quot; /var/log/iptables.log</span>
<span style="color: #888888">:msg,contains,&quot;UDP/IN:&quot; /var/log/iptables.log</span>
<span style="color: #888888">:msg,contains,&quot;UDP/OUT:&quot; /var/log/iptables.log</span>
</pre></div>
<br />
<b><u>Restarting service</u></b><br />
/etc/init.d/rsyslog restart

<div style="clear: both;"></div>
<b>Published: Sunday, October 11, 2015</b>
<hr>
</body></html>
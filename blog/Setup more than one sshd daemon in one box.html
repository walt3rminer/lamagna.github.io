<html>
<head>
<title>Setup more than one sshd daemon in one box</title>
<link rel="stylesheet" type="text/css" href="css/blogstyle.css">
</head>
<body style="margin:20;padding:0;">
<script language="javascript">
window.parent.document.title = "Setup more than one sshd daemon in one box";
</script>
<div id="section">



<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
<input type="hidden" name="cmd" value="_s-xclick">
<input type="hidden" name="hosted_button_id" value="7HY2N4VFEWYCL">
<input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_SM.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
¿ Te sirvió la data ? ¿ Te pareció interesante ? Con tu aporte puedo continuar. <img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
</form>

<hr>
<p id="postTitle"><a href="Setup%20more%20than%20one%20sshd%20daemon%20in%20one%20box.html" id="alink">Setup more than one sshd daemon in one box</a></p>
 You have one Linux server and want to set two ssh daemon, may be two different ssh servers each with a different version.<br /><br />1) Download the openssh from http://www.openssh.org/portable.html<br /><br />2) Configure and make the sources:<br /><span style="font-family:courier new;"># ./configure --with-kerberos5 --with-tcp-wrappers</span> --with-pam<br /><span style="font-family:courier new;"># ./make</span><br /><br />2.1) Common errors:<br /><pre>&quot;configure: error: PAM headers not found&quot;<br /><span style="font-weight: bold;font-family:arial;">Solution: yum install pam-devel</span><br /><br /></pre>3) You can do a &quot;make install&quot; but i wouldn&#39;t do that if you have already an ssh daemon installed, from sources or any package manager like rpm or apt.<br /><br />4) Copy the ssh daemon directory or link to it from /usr/local/sbin/<br /><span style="font-family:courier new;"># ln -s ./openssh-new /usr/local/sbin/sshd-new/</span><br /><br />5) Supposing that you already have a /etc/ssh/sshd_config file, then you have to create<br />another configuration file for the new ssh server, lets put it in another directory:<br /><span style="font-family:courier new;">/usr/local/etc/ssh/sshd_config</span><br /><br />And edit this sshd_config file and put there this line, or edit it if it already exists:<br /><span style="font-family:courier new;"># This line specifies which port you want to use:</span><br /><span style="font-family:courier new;">Port 2253 </span><br /><br />6) Create the ssh key files:<br /><span style="font-family:courier new;"># ssh-keygen -t rsa -f /usr/local/etc/ssh/ssh_host_rsa_key</span><br /><span style="font-family:courier new;"># ssh-keygen -t dsa -f /usr/local/etc/ssh/ssh_host_dsa_key</span><br /><br />7) Make sure that in the startup script /etc/init.d/sshd2 you instruct the daemon where to find its key files, something like this:<br /><br /><span style="font-family:courier new;"># Some functions to make the below more readable</span><br /><span style="font-family:courier new;">KEYGEN=/usr/local/sbin/openssh-5.2p1/ssh-keygen</span><br /><span style="font-family:courier new;">SSHD=/usr/local/sbin/openssh-5.2p1/sshd</span><br /><span style="font-family:courier new;">RSA1_KEY=/usr/local/etc/ssh/ssh_host_key</span><br /><span style="font-family:courier new;">RSA_KEY=/usr/local/etc/ssh/ssh_host_rsa_key</span><br /><span style="font-family:courier new;">DSA_KEY=/usr/local/etc/ssh/ssh_host_dsa_key</span><br /><span style="font-family:courier new;">PID_FILE=/var/run/sshd2.pid</span><br /><span style="font-family:courier new;">OPTIONS=&quot;-f /usr/local/etc/ssh/sshd_config&quot;</span><br /><br />8) Finally, start the new ssh server.<br />/etc/init.d/sshd2 start <div style="clear: both;"></div>
<b>Published: Saturday, June 13, 2009</b>

</div>

<hr>
</body></html>